"use strict";(self.webpackChunkvibhavari_bellutagi=self.webpackChunkvibhavari_bellutagi||[]).push([[5066],{2102:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>h});var t=i(313),s=i(4848),l=i(8453),a=i(1827);const o={slug:"de-bootcamp-dimensional-modelling-scd",title:"Dimensional Modelling - SCD",authors:["me"],tags:["de","dim","de-bootcamp","scd"],keywords:["data engineering","data engineering bootcamp","dimensional modeling","slowly changing dimensions"],hide_table_of_contents:!1},d=void 0,r={authorsImageUrls:[void 0]},h=[{value:"What is an Idempotent Pipeline?",id:"what-is-an-idempotent-pipeline",level:2},{value:"Why is hard to troubleshoot non-idempotent pipelines?",id:"why-is-hard-to-troubleshoot-non-idempotent-pipelines",level:3},{value:"What can make a pipline non-idempotent?",id:"what-can-make-a-pipline-non-idempotent",level:3},{value:"Few more problems that can make a pipeline non-idempotent",id:"few-more-problems-that-can-make-a-pipeline-non-idempotent",level:3},{value:"The pains of not having an idempotent pipeline",id:"the-pains-of-not-having-an-idempotent-pipeline",level:3},{value:"Slowly Changing Dimensions (SCD)",id:"slowly-changing-dimensions-scd",level:2},{value:"How can you model dimensions that change over time?",id:"how-can-you-model-dimensions-that-change-over-time",level:3},{value:"Types of Slowly Changing Dimensions",id:"types-of-slowly-changing-dimensions",level:3},{value:"Which types are idempotent?",id:"which-types-are-idempotent",level:3},{value:"Loading SCD2",id:"loading-scd2",level:3}];function c(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components},{Highlight:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Highlight",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Im sharing my learning from the Data Engineering Bootcamp, where we are learning about Data Engeering. Today we are learning about Dimensional modelling - Idempotency and SCDs."}),"\n",(0,s.jsxs)(n.p,{children:["I would like to extend my gratitude to Zach Wilson, the founder of ",(0,s.jsx)(n.a,{href:"https://bootcamp.techcreator.io/lessons",children:"DataExpert.io"}),", for his invaluable guidance and the comprehensive Data Engineering Bootcamp.\nConnect with Zach Wilson on ",(0,s.jsx)(n.a,{href:"https://www.linkedin.com/in/eczachly/",children:"LinkedIn"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Thank you, Zach, for this amazing intense bootcamp on Data engineering!"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.p,{children:"Day-2: Dimensional Modelling - Slowly Changing Dimensions (Theory)"}),"\n",(0,s.jsx)(n.h2,{id:"what-is-an-idempotent-pipeline",children:"What is an Idempotent Pipeline?"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Idempotency: An idempotent pipeline ensures that processing the same data multiple times (whether it's live production data or backfill data) yields the same result without any unintended side effects. This consistency is crucial for reliability and simplicity in data workflows."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Pipelines should produce the same results:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"The day they are run"}),"\n",(0,s.jsx)(n.li,{children:"How many times they are run"}),"\n",(0,s.jsx)(n.li,{children:"What hour they are run"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"why-is-hard-to-troubleshoot-non-idempotent-pipelines",children:"Why is hard to troubleshoot non-idempotent pipelines?"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Silent Failure: The non-idempotent pipelines can produce different results every time they are run, it doesnt fail. This results in ",(0,s.jsx)(i,{color:"#3e6980",children:"non reproduceable results"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"This causes inconsistency in the data to the downstream systems too."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"what-can-make-a-pipline-non-idempotent",children:"What can make a pipline non-idempotent?"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"INSERT INTO"})," without ",(0,s.jsx)(n.code,{children:"TRUNCATE"}),":","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["If you dont ",(0,s.jsx)(n.code,{children:"TRUNCATE"})," data before INSERT, it will keep on adding the data to the table, creating duplicates."]}),"\n",(0,s.jsx)(n.li,{children:"Thus your pipeline will not be idempotent, as it will keep on adding the data to the table."}),"\n",(0,s.jsxs)(n.li,{children:["Highly recommended to use ",(0,s.jsx)(i,{color:"#3e6980",children:"MERGE"})," or ",(0,s.jsx)(i,{color:"#3e6980",children:"INSERT OVERWRITE"})," always."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Using ",(0,s.jsx)(n.code,{children:"start_date >"})," without a corresponding ",(0,s.jsx)(n.code,{children:"end_date <"}),":","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["If you dont have ",(0,s.jsx)(n.code,{children:"end_date"})," in your SCD, you will not be able to track the changes in the data."]}),"\n",(0,s.jsx)(n.li,{children:"This can create a out of memory exceptions, when you backfill the data."}),"\n",(0,s.jsxs)(n.li,{children:["Highly recommended to use ",(0,s.jsx)(i,{color:"#3e6980",children:"end_date"})," in your SCD always."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Not using a full set of partition sensors:","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Your pipeline may run with partial set of inputs."}),"\n",(0,s.jsx)(n.li,{children:"pipeline might run when there is no/partial data"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Not using ",(0,s.jsx)(n.code,{children:"depends_on_past"})," for cumulative pipelines:","\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"When you process the data in parallel ( lets say processing parallel days ), pipeline may end up processing yesterday's data, which hasnt been created yet."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"The beauty of an idempotent pipeline lies in its ability to produce consistent results for both production and backfill data."})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Example:"}),"\nImagine a pipeline that:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Reads data (e.g., transactions)."}),"\n",(0,s.jsx)(n.li,{children:"Cleans and deduplicates it."}),"\n",(0,s.jsx)(n.li,{children:"Stores the cleaned data in a database."}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Production:"})," As new transactions come in, they\u2019re cleaned, deduplicated, and stored."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Backfill:"})," When historical transactions are added, they go through the same cleaning and deduplication process, ensuring no duplicate records and consistent results."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Because the pipeline is idempotent:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Processing the same data again won\u2019t alter the results or create issues."}),"\n",(0,s.jsx)(n.li,{children:"Whether it's production or backfill data, the behavior remains identical."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"few-more-problems-that-can-make-a-pipeline-non-idempotent",children:"Few more problems that can make a pipeline non-idempotent"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Relying on the ",(0,s.jsx)(n.strong,{children:"latest"})," partition of a not properly modeled SCD table.","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Cumulative table design AMPLIFIES this bug."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["One exception relying on latest partition is when you have properly modeled SCD table and ",(0,s.jsx)(i,{color:"#3e8045",children:"you are backfilling not in production"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"the-pains-of-not-having-an-idempotent-pipeline",children:"The pains of not having an idempotent pipeline"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Backfilling causes inconsistencies between the old and restated data."}),"\n",(0,s.jsx)(n.li,{children:"Hard to troubleshoot bugs and fix the issues."}),"\n",(0,s.jsx)(n.li,{children:"Unit testing cannot replicate the production behavior."}),"\n",(0,s.jsx)(n.li,{children:"The pipeline doesnt fail, but the data is inconsistent, which is silent failures."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"slowly-changing-dimensions-scd",children:"Slowly Changing Dimensions (SCD)"}),"\n",(0,s.jsx)(n.p,{children:"The Slowly Changing Dimensions (SCD) are dimensions that change slowly over time, which would have time frame with them. For example,"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Customer Address"}),"\n",(0,s.jsx)(n.li,{children:"Product Description"}),"\n",(0,s.jsx)(n.li,{children:"Employee Details"}),"\n",(0,s.jsx)(n.li,{children:"etc."}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"Not modelling the SCDs properly can impact the idempotency."})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"The slower the changes in a Slowly Changing Dimension (SCD), the more effectively it can be modeled."})}),"\n",(0,s.jsx)(n.h3,{id:"how-can-you-model-dimensions-that-change-over-time",children:"How can you model dimensions that change over time?"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Singular snapshot: The dimension table only contains the most recent data.","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Be Careful: This pipelines are not idempotent."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Daily partitioned snapshots: The dimension table contains a snapshot of the data for each day.","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Very simple way of implementing SCD."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"SCD Types 1,2,3"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"types-of-slowly-changing-dimensions",children:"Types of Slowly Changing Dimensions"}),"\n",(0,s.jsx)(n.p,{children:"Here\u2019s a Markdown table summarizing the content provided:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Type"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Description"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Key Features"})}),(0,s.jsx)(n.th,{children:(0,s.jsx)(n.strong,{children:"Limitations"})})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Type 0"})}),(0,s.jsx)(n.td,{children:"Static dimensions, not actually slowly changing."}),(0,s.jsxs)(n.td,{children:["- No temporal columns. ",(0,s.jsx)("br",{})," - Table contains only identifier and value."]}),(0,s.jsx)(n.td,{children:"- No changes tracked or maintained."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Type 1"})}),(0,s.jsx)(n.td,{children:"Overwrites old data with new data, only latest data is retained."}),(0,s.jsxs)(n.td,{children:["- Simple and efficient. ",(0,s.jsx)("br",{})," - No history maintained."]}),(0,s.jsx)(n.td,{children:"- Cannot retrieve historical data."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Type 2"})}),(0,s.jsx)(n.td,{children:"Gold standard of Slowly Changing Dimensions, maintains history using temporal columns."}),(0,s.jsxs)(n.td,{children:["- Uses ",(0,s.jsx)(n.code,{children:"start_date"})," and ",(0,s.jsx)(n.code,{children:"end_date"}),". ",(0,s.jsx)("br",{})," - Current rows have ",(0,s.jsx)(n.code,{children:"end_date = NULL"})," or ",(0,s.jsx)(n.code,{children:"9999-12-31"}),". ",(0,s.jsx)("br",{})," - Optionally uses ",(0,s.jsx)(n.code,{children:"is_current"})," column."]}),(0,s.jsx)(n.td,{children:"- More than one row per dimension can complicate filtering and querying."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Type 3"})}),(0,s.jsxs)(n.td,{children:["Maintains only two versions of the data: ",(0,s.jsx)(n.code,{children:"original"})," and ",(0,s.jsx)(n.code,{children:"current"}),"."]}),(0,s.jsx)(n.td,{children:"- One row per dimension."}),(0,s.jsxs)(n.td,{children:["- Loses history of changes between ",(0,s.jsx)(n.code,{children:"original"})," and ",(0,s.jsx)(n.code,{children:"current"}),". ",(0,s.jsx)("br",{})," - Partially idempotent."]})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"which-types-are-idempotent",children:"Which types are idempotent?"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Idempotent"}),(0,s.jsx)(n.th,{children:"Reason"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Type 0"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsx)(n.td,{children:"The values are unchanging."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Type 2"}),(0,s.jsx)(n.td,{children:"Yes"}),(0,s.jsxs)(n.td,{children:["It is idempotent, but you need to be careful with how you use the ",(0,s.jsx)(n.code,{children:"start_date"})," and ",(0,s.jsx)(n.code,{children:"end_date"}),"."]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Type 1"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Backfilling with this dataset gives the dimension as it is now, not as it was before."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Type 3"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:'Backfilling makes it impossible to determine whether to pick "original" or "current."'})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"loading-scd2",children:"Loading SCD2"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Load the entire history in one query","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Inefficient but nimble"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Incremnetally load the data after the previoud SCD is generated","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Has the same ",(0,s.jsx)(n.code,{children:"depends_on_past"}),". its efficient but cumbersome."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["I hope you enjoyed reading this blog on Slowly Changing Dimensions. If you have any questions or feedback, feel free to reach out to me on ",(0,s.jsx)(a.A,{})]})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},1827:(e,n,i)=>{i.d(n,{A:()=>l});i(6540);var t=i(5604),s=i(4848);const l=()=>{const e=[{name:"GitHub",icon:(0,s.jsx)(t.hL4,{}),url:"https://github.com/vibhabellutagi19"},{name:"Twitter",icon:(0,s.jsx)(t.feZ,{}),url:"https://x.com/buildwith_vibs"},{name:"LinkedIn",icon:(0,s.jsx)(t.QEs,{}),url:"https://www.linkedin.com/in/vibhavari-bellutagi-837871189/"},{name:"Instagram",icon:(0,s.jsx)(t.ao$,{}),url:"https://www.instagram.com/buildwith_vibs/"}];return(0,s.jsx)("div",{className:"social-container",children:e.map((e=>(0,s.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"social-link",children:(0,s.jsx)("span",{className:`social-icon ${e.name.toLowerCase()}`,children:e.icon})},e.name)))})}},313:e=>{e.exports=JSON.parse('{"permalink":"/blog/de-bootcamp-dimensional-modelling-scd","source":"@site/blog/2024-12-01-de-bootcamp-dimensional-modelling-scd/index.md","title":"Dimensional Modelling - SCD","description":"Im sharing my learning from the Data Engineering Bootcamp, where we are learning about Data Engeering. Today we are learning about Dimensional modelling - Idempotency and SCDs.","date":"2024-12-01T00:00:00.000Z","tags":[{"inline":false,"label":"data-engineering","permalink":"/blog/tags/de","description":"DE tag description"},{"inline":false,"label":"dimensional-modeling","permalink":"/blog/tags/dim","description":"Dimensional Modeling tag description"},{"inline":false,"label":"data-engineering-bootcamp","permalink":"/blog/tags/de-bootcamp","description":"Tags on Data Engineering Bootcamp by Zach Wilson"},{"inline":false,"label":"slowly-changing-dimension","permalink":"/blog/tags/scd","description":"Slowly Changing Dimension tag description"}],"readingTime":5.245,"hasTruncateMarker":true,"authors":[{"name":"Vibhavari Bellutagi","title":"Data Engineer","url":"https://buildwithvibs.in/","socials":{"github":"https://github.com/vibhabellutagi19","linkedin":"https://www.linkedin.com/in/vibhavari-bellutagi-837871189/","twitter":"https://twitter.com/buildwith_vibs"},"imageURL":"https://avatars.githubusercontent.com/u/39341524?s=400&u=5d760c052fe0614d3af649de9e85474d1cafeba7&v=4","key":"me","page":null}],"frontMatter":{"slug":"de-bootcamp-dimensional-modelling-scd","title":"Dimensional Modelling - SCD","authors":["me"],"tags":["de","dim","de-bootcamp","scd"],"keywords":["data engineering","data engineering bootcamp","dimensional modeling","slowly changing dimensions"],"hide_table_of_contents":false},"unlisted":false,"prevItem":{"title":"Data Modelling - Graph Databases and Additve Dimensions","permalink":"/blog/de-bootcamp-graph-databases"},"nextItem":{"title":"Dimensional Modelling - Cumulative Table","permalink":"/blog/de-bootcamp-dimensional-modelling"}}')}}]);